machine:
  post:
    - pyenv global 3.5.2

  environment:
    DEFAULT_CLIENT_HOST: 'http://localhost:4200'

dependencies:
  pre:
    - pyenv global 2.7.11
    - pip install -r requirements.txt
    - pyenv global 3.5.2
    - pip install -r requirements.txt


database:
  override:
    - createdb interview_manager
    - echo "CREATE USER vagrant WITH PASSWORD 'vagrant' SUPERUSER;" | psql -U postgres

test:
  override:
    - pyenv global 3.5.2
    - pip install -r requirements.txt
    - cd ./app && python manage.py test

deployment:
  production:
    branch: master
    commands:
      - pyenv global 2.7.12
      - pip install -r requirements.txt
      - pip install fabric fabtools
      - fab deploy
